<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2010-2013 Qualcomm Technologies, Inc. All rights reserved. 
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 header.html - Header file used to customize the headers on each HTML page for the API 
               Interface Specification documents.
 Updated:  03/08/13 LB Updated to support Doxygen 1.8.3.1.
 Updated:  10/25/12 LB Added company name changes.
 New file: 10/15/12 LB Created to support Rev E Alpha process using Doxygen 1.8.2 -->
<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"></meta>
<meta http-equiv="X-UA-Compatible" content="IE=9"></meta>
<title>Multicore Asynchronous Runtime Environment Heterogeneous Compute  Overview</title><!--END !PROJECT_NAME-->
<link href="tabs.css" rel="stylesheet" type="text/css"></link>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="autoEnterCurrentDate.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="is.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multicore Asynchronous Runtime Environment
   &#160;<span id="projectnumber">HT80-NG608-1 E</span>
   </div>
  </td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1-QCOM -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="revision_history.html"><span>Revision&#160;History</span></a></li>
      <li><a href="introduction.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="usergroup1.html"><span>User&#160;Guide</span></a></li>
      <li><a href="usergroup3.html"><span>Tutorials</span></a></li>
      <li><a href="usergroup4.html"><span>Reference&#160;Manual</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('heterogeneous_compute.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Heterogeneous Compute Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Most of the current hardware platforms, from desktops to tablets to smartphones, are built around multicore and heterogeneous systems on a chip (SoC). As the first step towards exploiting this heterogeneity, GPU (Graphics Processing Unit) support has been added to MARE. <a href="https://www.khronos.org/opencl/">OpenCL</a> C (an open and royalty free standard) is used as the kernel language for writing code which runs on the GPU. Users can continue to use the MARE abstractions of tasks, groups and pfor_each pattern to launch the OpenCL C kernels and need not worry about execution model details. The MARE runtime picks the best GPU device available on the platform, manages the underlying execution model for the device and provides an important abstraction of Shared Virtual Memory (SVM) through <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code>. The use of <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> relieves the programmer from having to manage data movement explicitly. It also future proofs applications by transparently leveraging future hardware SVM support, relieving the programmer of the burden of changing the application. Lets look at a simple example below which does addition of two vectors on the GPU, and highlights MARE's heterogeneous compute capabilities.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &lt;config.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;mare/mare.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;mare/alignedallocator.hh&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;mare/patterns.hh&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//Create a page aligned allocator.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keywordtype">size_t</span> Alignment&gt;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">using</span> aligned_vector = std::vector&lt;T, mare::aligned_allocator&lt;T, Alignment&gt; &gt;;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">using</span> page_aligned_vector = aligned_vector&lt;T, 4096&gt;;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//Create a string containing OpenCL C kernel code.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#define OCL_KERNEL(name, k) std::string const name##_string = #k</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;OCL_KERNEL(vadd_kernel,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  __kernel <span class="keywordtype">void</span> vadd(__global <span class="keywordtype">float</span>* A, __global <span class="keywordtype">float</span>* B, __global <span class="keywordtype">float</span>* C,</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size) {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = get_global_id(0);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordflow">if</span>(i &lt; size)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;       C[i] = A[i] + B[i];</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  });</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;main(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="comment">//Initialize the MARE runtime.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="group__init__shutdown.html#gac85658f566f4b5b1f17b9d81fe14a508">mare::runtime::init</a>();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">//Create input vectors</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  page_aligned_vector&lt;float&gt; a(1024);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  page_aligned_vector&lt;float&gt; b(a.size());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">//Initialize the input vectors</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; a.size(); ++i) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    a[i] = i;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    b[i] = a.size() - i;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">//Create mare::buffer with initialization data.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keyword">auto</span> buf_a = <a class="code" href="group__buffers__doc.html#gacac9232d5b0d128d266ff75c8d420e30">mare::create_buffer</a>(a.data(), a.size());</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">auto</span> buf_b = <a class="code" href="group__buffers__doc.html#gacac9232d5b0d128d266ff75c8d420e30">mare::create_buffer</a>(b.data(), b.size());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">//Create mare::buffer with no host ptr &amp; initialization data.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">auto</span> buf_c = mare::create_buffer&lt;float&gt;(a.size());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">//Name of the OpenCL C kernel.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  std::string kernel_name(<span class="stringliteral">&quot;vadd&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">//Create a kernel object,</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">auto</span> gpu_vadd = mare::create_kernel&lt;mare::buffer_ptr&lt;const float&gt;,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                      mare::buffer_ptr&lt;const float&gt;,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                      mare::buffer_ptr&lt;mare::out&lt;float&gt;&gt;,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;(vadd_kernel_string,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                    kernel_name);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">//Create a task attribute to mark the task as a gpu task.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keyword">auto</span> attrs = <a class="code" href="group__attributes.html#ga237e838bcedc75fcfb2f96ad604f1ea0">mare::create_task_attrs</a>(mare::attr::gpu);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size = a.size();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">//Create a mare::range object, 1D in this case.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="group__ranges__doc.html#classmare_1_1range_3_011_01_4">mare::range&lt;1&gt;</a> range_1d(a.size());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">//Create a ndrange_task</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">auto</span> gpu_task =</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="group__tasks__creation.html#gabd760eb3e61fec63535311045401be55">mare::create_ndrange_task</a>(range_1d,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                              <a class="code" href="group__tasks__doc.html#ga25f7bf623d3276d3f8ef7be928009650">mare::with_attrs</a>(attrs, gpu_vadd,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                               buf_a, buf_b, buf_c, size));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//Launch the task</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(gpu_task);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">//Wait for task completion.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(gpu_task);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">//compare the results.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; a.size(); ++i) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    MARE_INTERNAL_ASSERT(a[i] + b[i] == buf_c[i] &amp;&amp; buf_c[i] == a.size(),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                         <span class="stringliteral">&quot;comparison failed at ix %zu: %f + %f == %f == %zu&quot;</span>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                         i, a[i], b[i], buf_c[i], a.size());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//shutdown the mare runtime</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="group__init__shutdown.html#ga9876b6a82a27555a8f3affe7f7aa8c4c">mare::runtime::shutdown</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
</div><!-- fragment --><p>Lines 10-13 Create vectors using a page aligned allocator; creating host memory using an aligned allocator may optimize some of the copies done by the runtime. Although not mandatory, it is recommended to do all host allocations using an aligned allocator.</p>
<p>Lines 16-24 Create an OpenCL C kernel string.</p>
<p>Lines 33-40 Allocate host memory using the page aligned allocator for <code>buf_a</code> and <code>buf_b</code> and initializes them.</p>
<p>Lines 43-47 Create <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code>(s) <code>buf_a</code> and <code>buf_b</code> using host memory allocated earlier, it also creates <code>buf_c</code> without any host memory as backing store. If <code>buf_c</code> is not used before kernel launch then the first time it's used in a kernel, it will be allocated in device-accessible host memory. Hence subsequent accesses to <code>buf_c</code> can use the same host memory. However if <code>buf_c</code> is used before the kernel launch then MARE runtime allocates host memory as backing store and <code>buf_c</code> behaves similarly to <code>buf_a</code>.</p>
<p>Lines 53-58 Create a kernel object whose signature matches the OpenCL C kernel string created earlier. The template parameters dictates if buffer data is copied to device before launch or if buffer data is copied back from device when accessed on host. Here <code>buf_a</code> and <code>buf_b</code> are specified as const buffers i.e. they are not modified by the kernel, hence when they are accessed on host after kernel launch, data is not copied back from the device. Similarly buf_c is specified as <code>out&lt;float&gt;</code> which indicates it's an output only buffer and hence data is not copied to the device before kernel launch, however when <code>buf_c</code> is accessed after kernel launch, it's copied back from the device.</p>
<p>Lines 60-69 Create a gpu task attribute, a 1D range object and a ndrange_task with task attribute set to gpu. The kernel object passed to <code>mare::create_ndrange_task</code> is used for compile time type checking of actual kernel arguments passed.</p>
<p>Lines 73-76 Launch the gpu task and waits for it's completion.</p>
<p>Lines 79-83 Compare the results; note that the first time <code>buf_c</code> is accessed on the host after kernel launch, it is copied back from the device.</p>
<h1><a class="anchor" id="buffers_doc"></a>
Buffers Overview</h1>
<p>Different parts of an application may execute best on different devices. Orchestrating data movement for such an application is challenging and error prone. <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> provides an important abstraction of Shared Virtual Memory(SVM) that relieves the programmer from having to manage data movement explicitly. On hardware that supports SVM directly, some of the data movements can be avoided. Currently only GPU devices are supported and all further references to device refer to GPU. Buffers can be created in different ways as shown below:</p>
<p>Creating a <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> without any initialization (host) data. </p>
<div class="fragment"><div class="line"><span class="comment">// Create a buffer with 1k elements.</span></div>
<div class="line"><span class="keyword">auto</span> buf_a = mare::create_buffer&lt;float&gt;(1024);</div>
<div class="line"></div>
</div><!-- fragment --><p>Creating a <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> with existing host data. </p>
<div class="fragment"><div class="line"><span class="comment">// Use the aligned allocator to allocate host data</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keywordtype">size_t</span> Alignment&gt;</div>
<div class="line"><span class="keyword">using</span> aligned_vector = std::vector&lt;T, mare::aligned_allocator&lt;T, Alignment&gt; &gt;;</div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="keyword">using</span> page_aligned_vector = aligned_vector&lt;T, 4096&gt;;</div>
<div class="line"></div>
<div class="line"><span class="comment">// allocate host memory for 1k floats.</span></div>
<div class="line">page_aligned_vector&lt;float&gt; host_ptr(1024);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Create a buffer from existing host data</span></div>
<div class="line"><span class="keyword">auto</span> buf_a = <a class="code" href="group__buffers__doc.html#gacac9232d5b0d128d266ff75c8d420e30">mare::create_buffer</a>(host_ptr, 1024);</div>
<div class="line"></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>Once a buffer has been created using <code>ptr</code>, manipulating the underlying data directly using the raw <code>ptr</code> is undefined.</dd></dl>
<p>Buffers are managed using the following three principles:</p>
<ul>
<li><p class="startli"><b>Allocate on first use</b>: Memory required as backing store for <a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a> is allocated based on where it gets used. Some of the scenarios are detailed below:</p>
<ul>
<li>Creating a <code> <a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> without any initialization (host) data.<ul>
<li>Used on host before kernel launch, MARE runtime allocates host memory as backing store, this <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> behaves similarly to one allocated with user provided host pointer.</li>
<li>Used only in kernel, memory is allocated in device-accessible host memory, any further use of <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> on host will use the same memory.</li>
</ul>
</li>
</ul>
<ul>
<li>Creating a <code> <a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> created with existing host data.<ul>
<li>Used only on host, no device memory will be created.</li>
<li>Used in kernel launch; a copy is done depending on the type of kernel arguments (see the table below).</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><b>Copy when required</b>: Data movement happens only when needed; it is dictated by the kernel parameter types used in <code>mare::create_kernel</code> and the actual arguments passed to <code>mare::create_ndrange_task</code>.<ul>
<li>copy-in copies to device</li>
<li>copy-out copies from device <table class="doxtable">
<tr>
<th>Kernel Parameter &ndash;&gt; </th><th>T / inout&lt;T&gt; </th><th>const T / in&lt;T&gt; </th><th>out&lt;T&gt;  </th></tr>
<tr>
<td>Buffer Type </td><td></td><td></td><td></td></tr>
<tr>
<td>T </td><td>copy-in and copy-out </td><td>copy-in, no copy-out </td><td>no copy-in, only copy-out  </td></tr>
<tr>
<td>const T </td><td>Invalid, compile&#160;<br/>
time error. </td><td>no copy-out </td><td>Invalid, compile time&#160;<br/>
error.  </td></tr>
</table>
</li>
</ul>
</li>
</ul>
<ul>
<li><b>No implicit thread safety</b>: The following applies for concurrent access of <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code>.<ul>
<li>Cannot be accessed concurrently across multiple devices</li>
<li><code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> elements can be accessed concurrently after calling <code><a class="el" href="group__buffers__doc.html#a18a54499f6644c94d78b02b35476df71">mare::buffer::sync</a></code> (GPU implicitly synchronizes buffers that are kernel arguments before kernel execution)</li>
<li><code><a class="el" href="group__buffers__doc.html#a18a54499f6644c94d78b02b35476df71">mare::buffer::sync</a></code> &amp; other <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> APIs are not thread-safe</li>
<li>Accessing <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> elements triggers an implicit copy when required; consequently <code><a class="el" href="group__buffers__doc.html#classmare_1_1buffer">mare::buffer</a></code> elements cannot be accessed concurrently from tasks or threads without prior synchronization using <code><a class="el" href="group__buffers__doc.html#a18a54499f6644c94d78b02b35476df71">mare::buffer::sync</a></code></li>
</ul>
</li>
</ul>
<dl class="section user"><dt>For using Heterogeneous Compute API on different platforms,</dt><dd>please refer to the requirements specified in <a class="el" href="binaries.html">Installing MARE</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2012-2013 Qualcomm Technologies, Inc. All rights reserved. 
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 footer.html - footer file used to customize the footers on each HTML page for the API 
               Interface Specification documents.
 Updated:  11/05/13 LB Removed confidential, distribution, and export statement.
 Updated:  09/20/13 LB Updated to support mare project's User Guide and API doc.
 Updated:  04/18/13 LB Added Documentation and Interface Specification in place of hard-coding doc dcn. Deleted original
                       use of Documentation and Interface Specification to display text in the left portion of the footer.
 Updated:  03/08/13 LB Updated to support Doxygen 1.8.3.1
 Updated:  01/18/13 LB Replaced qualcomm_logo.gif to QTI_Logo.png
 Updated:  10/25/12 LB Added company name changes.
 New file: 10/15/12 LB Created to support the Rev E Alpha Doxygen-to-HTML-PDF process. -->
<!-- start footer part -->
<!-- 7/12/12 JG added div class defined in css to include warning statement on all pages -->
<!--[if lte IE 8]><div class="warningmsgie8"><![endif]-->
<!--[if(gte IE 9)|!(IE)]><!--><div class="warningmsg"><!--<![endif]-->
</div>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="userguide.html">User Guide</a></li>
    <li class="footer">
		<p align="right">HT80-NG608-1 E<br />
        <img class="footer"  alt="QTI Logo" src="qti_logo_HTML.png" />
		</p>
		</li>
  </ul>
</div>
</body>
</html>
