<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2010-2013 Qualcomm Technologies, Inc. All rights reserved. 
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 header.html - Header file used to customize the headers on each HTML page for the API 
               Interface Specification documents.
 Updated:  03/08/13 LB Updated to support Doxygen 1.8.3.1.
 Updated:  10/25/12 LB Added company name changes.
 New file: 10/15/12 LB Created to support Rev E Alpha process using Doxygen 1.8.2 -->
<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"></meta>
<meta http-equiv="X-UA-Compatible" content="IE=9"></meta>
<title>Multicore Asynchronous Runtime Environment Groups</title><!--END !PROJECT_NAME-->
<link href="tabs.css" rel="stylesheet" type="text/css"></link>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="autoEnterCurrentDate.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="is.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Multicore Asynchronous Runtime Environment
   &#160;<span id="projectnumber">HT80-NG608-1 E</span>
   </div>
  </td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1-QCOM -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="revision_history.html"><span>Revision&#160;History</span></a></li>
      <li><a href="introduction.html"><span>Introduction</span></a></li>
      <li><a href="usergroup0.html"><span>Getting&#160;Started</span></a></li>
      <li><a href="usergroup1.html"><span>User&#160;Guide</span></a></li>
      <li><a href="usergroup3.html"><span>Tutorials</span></a></li>
      <li><a href="usergroup4.html"><span>Reference&#160;Manual</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('groups.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Groups </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Groups"></a></p>
<p>One of the most common parallel programming patterns is fork and join. The idea is quite intuitive. At the fork, the application splits the job-to-be-done into many tasks. At the join, the application waits for all of them to complete before continuing with its execution.</p>
<p>An example of fork and join could be styling a website. During the styling phase, a parallel web browser could traverse the DOM tree and spawn one task per DOM element. Each of the tasks would be responsible for styling an element. The browser can only render the page once all the styling tasks complete.</p>
<p>Calling <code>mare::wait_for</code> for each task is cumbersome: the programmer would have to store the task pointers into some data structure, and call <code>mare::wait_for</code> for each of them after visiting all nodes. A group is a MARE abstraction that allows the programmer to wait for a set of tasks to complete, relieving the programmer from having to wait for each task separately.</p>
<p>It is easy to imagine that, in addition to the styling tasks, the parallel browser would have launched other tasks to do HTML parsing, Javascript execution, etc... A logical design decision would be to have all the tasks working on the same page to belong to the same group. Notice that the styling tasks would need to belong to two groups: the "Page XYZ" group, and the "Page XYZ-styling" group. MARE supports tasks tasks that belong to multiple groups.</p>
<p><code>mare::wait_for(mare::group_ptr const&amp;)</code> is not the only operation that can be done with groups. The method <code>mare::cancel(mare::group_ptr const&amp;)</code> cancels all the tasks in a group. In our parallel browser example, this would allow the browser to easily cancel all the tasks in the "Page XYZ" group when the user decides to navigate to a new page before the current one displays.</p>
<p>In summary, *groups are sets of tasks that can be canceled or waited for as a unit*.</p>
<h1><a class="anchor" id="creating-groups"></a>
Group Creation</h1>
<p>Use <code><a class="el" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group()</a></code> to create a new group.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>();</div>
</div><!-- fragment --><p>Use <code>mare::create_group(std::string const&amp; name)</code> to create a new group called &lt;name&gt;. Group names are only used for debugging applications, MARE does not check for duplicate group names.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group named &quot;Example&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
</div><!-- fragment --><p>Use <code>mare::group_name(mare::group_ptr const&amp;)</code> to get the group name:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group named &quot;Example&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;std::string name = <a class="code" href="group__groups__doc.html#ga7eeb21a32ba125a8bad942416abe8e9b">mare::group_name</a>(g); <span class="comment">// returns &quot;Example&quot;</span></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>In the current MARE release, there can only exist 32 groups at a given time. Trying to create a 33rd one will result in an exception.</dd></dl>
<h2><a class="anchor" id="group_ptrs"></a>
The group_ptr pointer</h2>
<p>The method <code><a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> mare::create_group(std::string const&amp; name)</code> returns an object of type <code><a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a></code>, which is a custom smart pointer to the group object. <code><a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a></code> pointers behave similarly to <code><a class="el" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a></code>. Therefore, groups are reference counted, and they are automatically destroyed when there are no more <code><a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a></code> pointers pointing to them. This means that even if the user has no pointers to the group, MARE will not destroy the group until all its tasks complete.</p>
<p>The current MARE release does not support <code>mare::unsafe_group_ptr</code>, but a future one will.</p>
<h1><a class="anchor" id="add_task_group"></a>
Adding Tasks to Groups</h1>
<p>There are three ways to add a task into a group:</p>
<dl class="section user"><dt>Create and Launching</dt><dd>By creating a new task and immediately launching it using <code>template&lt;typename Body&gt; void mare::launch(<a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> const&amp;, Body&amp;&amp;)</code>. Use this method when the task does not have predecessor or successors. This is the most performant way to create and launch a task in MARE. This is because the MARE runtime knows that the programer has no pointer to the task and it can perform aggressive optimizations. It is for this reason that <code>template&lt;typename Body&gt; void mare::launch(mare::group_ptr const&amp;, Body&amp;&amp;)</code> does not return a <code><a class="el" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a></code>. Use this method as much as you can:</dd></dl>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group named &quot;Example&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create and launch tasks into g</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; 1000; i++)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g, []{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>); });</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Wait for all the tasks in group g to complete</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g);</div>
</div><!-- fragment --><dl class="section user"><dt>Launching </dt><dd>By launching an existing task using <code> void mare::launch_and_reset(mare::group_ptr const&amp;, mare::task_ptr&amp;)</code> or<code> void mare::launch(<a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> const&amp;, <a class="el" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> const&amp;)</code>. Use these methods when the task is part of a DAG. The former is more performant than the latter because the MARE runtime can infer that the programmer has no pointer to the task. Thus, we recommend that you use <code> void mare::launch_and_reset(mare::group_ptr const &amp;, mare::task_ptr&amp;)</code> if you do not need the <code><a class="el" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a></code> pointer after the method call.</dd></dl>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create Example group</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create tasks</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t1 = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([]{ printf(<span class="stringliteral">&quot;Hello World from t1!\n&quot;</span>);});</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t2 = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([]{ printf(<span class="stringliteral">&quot;Hello World from t2!\n&quot;</span>);});</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Launch t1 into g,</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g, t1);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// Use t1</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<a class="code" href="group__dependencies.html#gab0a753d6b37824e4b5349c411b155ca2">mare::after</a>(t1, t2);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// t1 pointer no longer needed, reset it</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;t1.<a class="code" href="group__tasks__doc.html#ac80e9dab431aa871d74fe5b957050a1e">reset</a>();</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Launch t2 into g and reset task pointer</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<a class="code" href="group__execution.html#ga40aa3b0fcca0613706a53324a87f2926">mare::launch_and_reset</a>(g, t2);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// Wait for tasks to complete</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g);</div>
</div><!-- fragment --><dl class="section user"><dt>Joining </dt><dd>By explicitly adding it into the group using: <code>void mare::join_group(<a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> const &amp;, <a class="el" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> const &amp;)</code>. This method is slow, and it should be employed scarcely. Use it only when you absolutely need the task to belong to a group (perhaps you want to prevent the group from being empty so you can wait on it somewhere else), but you're not ready to launch the task just yet.</dd></dl>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group g</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create task t1</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t1 = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([]{ printf(<span class="stringliteral">&quot;Hello World from t1!\n&quot;</span>);});</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Add t1 to g. Don&#39;t do this often</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<a class="code" href="group__grouping.html#gad6f329fcb231dc2b93be5f5f50431548">mare::join_group</a>(g, t1);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Launch t1. Because it belongs to group g,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// there is no reason to launch it into the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// same group again.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(t1);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// t1 no longer needed, reset pointer</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;t1.<a class="code" href="group__tasks__doc.html#ac80e9dab431aa871d74fe5b957050a1e">reset</a>();</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Wait for tasks in group g to complete</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g);</div>
</div><!-- fragment --><p>Regardless of the method you use, the following rules always apply:</p>
<ul>
<li>Tasks stay in the group until they complete execution. Once a task is added to a group, there is no way to remove it from the group.</li>
</ul>
<ul>
<li>Once a task belonging to multiple groups completes execution, MARE removes it from all the groups it belongs.</li>
</ul>
<ul>
<li>Neither completed nor canceled tasks can join groups.</li>
</ul>
<ul>
<li>Tasks can not be added to a canceled group.</li>
</ul>
<h2><a class="anchor" id="add_task_multigroups"></a>
Adding a Task to Multiple Groups</h2>
<p>There are two ways to add a task to more than group:</p>
<ul>
<li>By launching it into each of the groups. For example, to add task <code>t</code> to groups <code>g1</code> and <code>g2</code>, we would do the following:</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create task</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([]{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>);});</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 1&quot;</span>);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 2&quot;</span>);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Launch t into g1 and g2</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g1, t);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g2, t);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(t);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
</div><!-- fragment --><p>Notice that, in the example above, <code>t</code> joins both <code>g1</code> and <code>g2</code>, but it only executes once. Therefore, the code snippet outputs a single 'Hello World!'. However, You must understand that <code>t</code> might never join <code>g2</code> because it might complete execution before the first launch returns. Remember that completed tasks can never join groups.</p>
<ul>
<li>By creating a new group that is the intersection of all the groups where the task needs to launch, and then launch the task into it. <code> <a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> mare::intersect(<a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> const &amp;, <a class="el" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> const &amp;)</code> returns a group pointer to a group that represents the intersection of the two groups passed as arguments. This method is more performant than repeatedly launching the same task into different groups.</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create task</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([]{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>);});</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 1&quot;</span>);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 2&quot;</span>);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = <a class="code" href="group__groups__creation.html#ga166d4a86d73f242aabedb22d1d065036">mare::intersect</a>(g1, g2);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Launch t into g1 and g2</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g12, t);</div>
</div><!-- fragment --><h3><a class="anchor" id="group_intersection"></a>
Group Intersection</h3>
<p>It is important to understand what group intersection really means, because it might appear counterintuitive. <code>mare::intersect</code> returns a pointer to a group that represents the intersection of two or more groups. Launching a task into the intersection group means simultaneously launching it into all the groups that are part of the intersection. Intersection groups do not count towards the 31 maximum number of simultaneous groups in the application.</p>
<p>For example, the following code snippet shows an application with two groups, <code>g1</code> and <code>g2</code>, with 100 and 200 tasks in each, respectively.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 1&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 2&quot;</span>);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;100; i++)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g1, []{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;      <span class="comment">//... Do something</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    });</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;200; i++)</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g2, []{</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      <span class="comment">//... Do something</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    });</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = <a class="code" href="group__groups__creation.html#ga166d4a86d73f242aabedb22d1d065036">mare::intersect</a>(g1, g2);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Returns immediately. g12 is empty</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g12);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// Return only after tasks in g1 and g2 complete</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g1);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g2);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<a class="code" href="group__tasks__doc.html#classmare_1_1task__ptr">mare::task_ptr</a> t = <a class="code" href="group__tasks__creation.html#ga4d2a57c19a9199c7ccee7a01ff688da8">mare::create_task</a>([] {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//... Calculate the Ultimate Question of Life, the Universe, and Everything</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    printf(<span class="stringliteral">&quot;42\n&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  });</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g12, t);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// All will return after the task prints 42</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g1);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g2);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
</div><!-- fragment --><p>In line 16, we intersect <code>g1</code> and <code>g2</code> into <code>g12</code>. The returned pointer, <code>g12</code>, points to an empty group because no task belongs to both <code>g1</code> and <code>g2</code> yet. Therefore, <code>mare::wait_for(g12)</code> in line 19 returns immediately. The <code>wait_for</code> calls in lines 22 and 23 only return when their tasks complete. In line 30, we launch <code>t</code> into <code>g12</code>. The <code>wait_for</code> calls in lines 31 and 32 only return after <code>t</code> completes execution because <code>t</code> belongs to both <code>g1</code> and <code>g2</code> (and, of course, <code>g12</code>).</p>
 <b>Note:</b> You can use the <code>&amp;</code> operator instead of <code>mare::intersect</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Get pointer to intersection groups:</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = g1 &amp; g2;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g21 = g2 &amp; g1;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This assert will never fire</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;assert(g12 == g21);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
</div><!-- fragment --><p>You must keep in mind that group intersection is a somewhat expensive operation. If you need to intersect groups repeatedly, just do it once and keep the pointer to the group intersection alive.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = g1 &amp; g2;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Launch 1000 tasks into g1 and g2</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1000; i++) {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g12, []{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>);});</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; }</div>
</div><!-- fragment --><p>Therefore, the code snippet above is much faster than the one below:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Launch 1000 tasks into g1 and g2</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1000; i++){</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g1 &amp; g2, []{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>);});</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; }</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
</div><!-- fragment --><p>Consecutive calls to <code>mare::intersect</code> with the same groups pointer as arguments return a pointer to the same group. In addition, group intersection is commutative:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Get pointer to intersection groups:</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = g1 &amp; g2;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g21 = g2 &amp; g1;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// This assert will never fire</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;assert(g12 == g21);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
</div><!-- fragment --><p>and associative:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g3 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Group 3&quot;</span>);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Get pointers to intersection groups:</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12_3 = (g1 &amp; g2) &amp; g3;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1_23 = g1 &amp; (g2 &amp; g3);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2_13 = g2 &amp; (g1 &amp; g3);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// These asserts will never fire</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;assert(g12_3 == g1_23);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;assert(g12_3 == g2_13);</div>
</div><!-- fragment --><h2><a class="anchor" id="wait_for_group"></a>
Waiting For a Group</h2>
<p><code>mare::wait_for(mare::group_ptr const &amp;)</code> does not return until all the tasks in it have completed execution or have been canceled.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example&quot;</span>);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Launch 1000 tasks into g</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 1000; i++){</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g, []{ printf(<span class="stringliteral">&quot;Hello World!\n&quot;</span>);});</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; }</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Wait for tasks to complete</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
</div><!-- fragment --> <p style="margin-left:.5in; text-indent:-.5in"><b>Note:&nbsp;</b> As in <code>mare::wait_for(mare::task_ptr const &amp;)</code>, if <code>mare::wait_for(mare::group_ptr const &amp;)</code> is called from within a task, MARE context switches the task and finds another task to run. If called from outside a task, it blocks the calling thread until it returns.</p>
<p>Waiting for an intersection group means that MARE returns once the tasks in the intersection group have completed or canceled.</p>
<p>For example, <code>mare::wait_for(g12)</code> in the following code returns immediately, because there are no tasks in <code>g12</code>. Neither <code>mare::wait_for(g1)</code> nor <code>mare::wait_for(g2)</code> would return.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create groups</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g1 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 1&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g2 = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;Example 2&quot;</span>);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<a class="code" href="group__groups__doc.html#classmare_1_1group__ptr">mare::group_ptr</a> g12 = g1 &amp; g2;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Create and launch two tasks that never end</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g1, []{</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordflow">while</span>(1) {}</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  });</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g2, []{</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">while</span>(1) {}</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  });</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// Returns immediately because there are no</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// tasks that belong to both g1 and g2</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g12);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// Never returns</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
</div><!-- fragment --><p><code>mare::wait_for(mare::group_ptr const &amp;)</code> and is a safe point. For information about safe points, see <a class="el" href="issues.html">Interoperability</a>.</p>
<h1><a class="anchor" id="group_cancelation"></a>
Group Cancelation</h1>
<p>Use <code>mare::cancel(mare::group_ptr const &amp;)</code> to cancel all the tasks in a group. Canceling a group means that:</p>
<ul>
<li>The group tasks that have not started execution will never execute.</li>
<li>The group tasks that are executing will be canceled only when they call <code>mare::abort_on_cancel</code>. If any of these executing tasks is a blocking task, MARE will execute its cancel handler if they had not executed it before.</li>
<li>Any tasks added to the group after the group is canceled will also be canceled.</li>
</ul>
<p>In the following example, we launch 10000 tasks and then sleep for some time so that a few of those 10000 tasks are done, a few others are executing and a large majority are waiting to be executed. In line 24 we cancel the group. This means that next time the running tasks execute <code><a class="el" href="group__tasks__cancelation.html#gad97de382780eb082e5341a23cf45dec9">mare::abort_on_cancel()</a></code> they will see that their group has been canceled and will abort. <code>wait_for(g)</code> will not return before the running tasks end their execution &mdash; either because they call <code><a class="el" href="group__tasks__cancelation.html#gad97de382780eb082e5341a23cf45dec9">mare::abort_on_cancel()</a></code> or because they finish writing all the messages.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Create group</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">auto</span> g = <a class="code" href="group__groups__creation.html#ga164f9c8b577069b2d8b1634cde459b1e">mare::create_group</a>(<span class="stringliteral">&quot;example&quot;</span>);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Create lambda for task body.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">auto</span> body = []() {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; ++i) {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    <a class="code" href="group__tasks__cancelation.html#gad97de382780eb082e5341a23cf45dec9">mare::abort_on_cancel</a>();</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    printf(<span class="stringliteral">&quot;Hello world %d\n&quot;</span>, i);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    sleep(1);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  }</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;};</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// Launch many tasks</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 10000; ++j) {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <a class="code" href="group__sdf__doc.html#gaf6d88ec9965da7eaa9da60ab7c27041b">mare::launch</a>(g, body);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Wait for a little bit, to give a</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// few tasks time to complete their</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// execution</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;sleep(10);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Cancel group and wait for the</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// running tasks to complete</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<a class="code" href="group__groups__cancel.html#ga432f04a0f64afdd64f3b83000bddc042">mare::cancel</a>(g);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<a class="code" href="group__groups__waiting.html#gaa2a0ab6d7f24ae0840b581bfa8e94fea">mare::wait_for</a>(g);</div>
</div><!-- fragment --><p>Like <code>mare::cancel(mare::task_ptr const &amp;)</code>, <code>mare::cancel(mare::group_ptr const &amp;)</code> returns immediately. Use <code>mare::wait_for(mare::group_ptr const &amp;)</code> after <code>mare::cancel(mare::group_ptr const &amp;)</code> to block execution until the group is empty.</p>
<dl class="section warning"><dt>Warning</dt><dd>Once a group is canceled, it cannot be "uncanceled". </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  Copyright (c) 2012-2013 Qualcomm Technologies, Inc. All rights reserved. 
  Confidential and Proprietary - Qualcomm Technologies, Inc.
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 footer.html - footer file used to customize the footers on each HTML page for the API 
               Interface Specification documents.
 Updated:  11/05/13 LB Removed confidential, distribution, and export statement.
 Updated:  09/20/13 LB Updated to support mare project's User Guide and API doc.
 Updated:  04/18/13 LB Added Documentation and Interface Specification in place of hard-coding doc dcn. Deleted original
                       use of Documentation and Interface Specification to display text in the left portion of the footer.
 Updated:  03/08/13 LB Updated to support Doxygen 1.8.3.1
 Updated:  01/18/13 LB Replaced qualcomm_logo.gif to QTI_Logo.png
 Updated:  10/25/12 LB Added company name changes.
 New file: 10/15/12 LB Created to support the Rev E Alpha Doxygen-to-HTML-PDF process. -->
<!-- start footer part -->
<!-- 7/12/12 JG added div class defined in css to include warning statement on all pages -->
<!--[if lte IE 8]><div class="warningmsgie8"><![endif]-->
<!--[if(gte IE 9)|!(IE)]><!--><div class="warningmsg"><!--<![endif]-->
</div>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="userguide.html">User Guide</a></li>
    <li class="footer">
		<p align="right">HT80-NG608-1 E<br />
        <img class="footer"  alt="QTI Logo" src="qti_logo_HTML.png" />
		</p>
		</li>
  </ul>
</div>
</body>
</html>
